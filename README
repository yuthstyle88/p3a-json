## ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤

‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡πà‡∏ß‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤:

1. Fork ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á branch ‡πÉ‡∏´‡∏°‡πà (`git checkout -b feature/amazing-feature`)
3. Commit ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á (`git commit -m 'Add some feature'`)
4. Push ‡πÑ‡∏õ‡∏¢‡∏±‡∏á branch (`git push origin feature/amazing-feature`)
5. ‡∏™‡∏£‡πâ‡∏≤‡∏á Pull Request

## License

‡∏£‡∏∞‡∏ö‡∏∏ License ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

## ‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤

- ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì - [GitHub](https://github.com/yourusername)
# üöÄ Telemetry Events API

‡∏£‡∏∞‡∏ö‡∏ö API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö Telemetry Events ‡∏î‡πâ‡∏ß‡∏¢ Rust + Actix-web + SQLx + PostgreSQL

---

## ‚ú® ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (Features)

- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• telemetry (event ‡∏à‡∏≤‡∏Å app, browser, ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå)
- ‡∏°‡∏µ Auth Middleware ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Header (BraveServiceKey)
- Rust async performance, ‡πÉ‡∏ä‡πâ connection pool
- ‡πÉ‡∏ä‡πâ Database Partition ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö SQLx Migration

---

## üì¶ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á (Installation)

### Prerequisites

- Rust (1.73.0+)
- PostgreSQL (14.0+)
- SQLx CLI (`cargo install sqlx-cli --no-default-features --features postgres`)

### 1. Clone ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

```bash
git clone https://github.com/youruser/telemetry_events.git
cd telemetry_events
```

### 2. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies

```bash
cargo build
```

### 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

```bash
createdb telemetry_db
```

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏ó‡∏µ‡πà root ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ ‡πÄ‡∏ä‡πà‡∏ô

```env
DATABASE_URL=postgres://yongyutjantaboot@localhost:5432/telemetry_db
BRAVE_SERVICE_KEY=qztbjzBqJueQZLFkwTTJrieu8Vw3789u
```

---

## üîÑ Database Migration

### ‡∏™‡∏£‡πâ‡∏≤‡∏á Migration ‡πÉ‡∏´‡∏°‡πà

```bash
sqlx migrate add create_telemetry_events
```

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á SQL Migration

```sql
CREATE TABLE telemetry_events (
    id BIGSERIAL NOT NULL,
    cadence TEXT NOT NULL,
    channel TEXT NOT NULL,
    country_code TEXT NOT NULL,
    metric_name TEXT NOT NULL,
    metric_value INTEGER NOT NULL,
    platform TEXT NOT NULL,
    version TEXT NOT NULL,
    woi SMALLINT NOT NULL,
    wos SMALLINT NOT NULL,
    yoi SMALLINT NOT NULL,
    yos SMALLINT NOT NULL,
    received_at TIMESTAMPTZ NOT NULL DEFAULT now(),
    UNIQUE (id, received_at)
) PARTITION BY RANGE (received_at);

CREATE TABLE telemetry_events_y2025
PARTITION OF telemetry_events
FOR VALUES FROM ('2025-01-01') TO ('2026-01-01');

CREATE TABLE telemetry_events_default
PARTITION OF telemetry_events DEFAULT;
```

### ‡∏£‡∏±‡∏ô Migration

```bash
sqlx migrate run
```

---

## ‚ö° ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô API

### Endpoint

`POST /`

**Body ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:**

```json
{
  "cadence": "typical",
  "channel": "release",
  "country_code": "th",
  "metric_name": "Brave.Today.WeeklySessionCount",
  "metric_value": 1,
  "platform": "ios",
  "version": "1.0",
  "woi": 21,
  "wos": 21,
  "yoi": 2025,
  "yos": 2025
}
```

**‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á Header:**
```
BraveServiceKey: qztbjzBqJueQZLFkwTTJrieu8Vw3789u
```

---

## üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤ (Development)

- ‡πÄ‡∏û‡∏¥‡πà‡∏° dependencies ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô `Cargo.toml`
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö .env ‡∏î‡πâ‡∏ß‡∏¢ dotenvy
- Middleware ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Auth ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö key

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ (Project Structure)

```
telemetry_events/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ main.rs
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ YYYYMMDD_create_telemetry_events.up.sql
‚îÇ   ‚îî‚îÄ‚îÄ YYYYMMDD_create_telemetry_events.down.sql
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ Cargo.toml
‚îî‚îÄ‚îÄ README.md
```

---

## License

MIT

## Contributors

- Yongyut Jantaboot (Yut) - [GitHub](https://github.com/yourusername)

---